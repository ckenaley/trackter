<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compute half wavelengths from a sine-like waveform — halfwave • trackter</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Compute half wavelengths from a sine-like waveform — halfwave" />
<meta property="og:description" content="Computes half wavelengths and their positions and amplitude from a sine-like waveform based on either peak-to-trough or internodal distance." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">trackter</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/tutorial.html">tutorial</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute half wavelengths from a sine-like waveform</h1>
    
    <div class="hidden name"><code>halfwave.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes half wavelengths and their positions and amplitude from a sine-like waveform based on either peak-to-trough or internodal distance.</p>
    </div>

    <pre class="usage"><span class='fu'>halfwave</span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>y</span>,
  method <span class='op'>=</span> <span class='st'>"zeros"</span>,
  zero.begin <span class='op'>=</span> <span class='cn'>TRUE</span>,
  fit <span class='op'>=</span> <span class='cn'>TRUE</span>,
  dens <span class='op'>=</span> <span class='fl'>10</span>,
  smooth <span class='op'>=</span> <span class='fl'>0.1</span>,
  smoothing <span class='op'>=</span> <span class='st'>"loess"</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>Numeric; x position</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>numeric; y position</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>character; how half waves should be found and classified, where it crosses zero/the internodal length ("zeros") or peak to trough/trough to peak ("p2t"). See Details.</p></td>
    </tr>
    <tr>
      <th>zero.begin</th>
      <td><p>logical; does wave begin at zero? Default is 'TRUE' and will help find waves beginning at first x,y values if y=0</p></td>
    </tr>
    <tr>
      <th>fit</th>
      <td><p>logical; if 'method="zeros"', should zeros be detected by a fitting operation. See Details.</p></td>
    </tr>
    <tr>
      <th>dens</th>
      <td><p>numeric; factor by which to increase the sample density used in fitting when 'method="zeros"'. See Details.</p></td>
    </tr>
    <tr>
      <th>smooth</th>
      <td><p>numeric; if <code>smoothing</code> is set to 'loess', 'span' parameter value for <code><a href='https://rdrr.io/r/stats/loess.html'>loess</a></code>. If <code>smoothing</code> is set to 'spline' 'spar' parameter value for <code><a href='https://rdrr.io/r/stats/smooth.spline.html'>smooth.spline</a></code></p></td>
    </tr>
    <tr>
      <th>smoothing</th>
      <td><p>character; the smoothing method when 'fit=TRUE', either 'loess' or 'spline'. See Details.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with the following components:</p>
<p><code>method</code> the method chosen to find half waves</p>
<p><code>names</code> a data table with columns 'x', 'y', and 'wave' describing the x and y positions of the wave and a numeric name of each half wave detected, resptively.  If 'method="zeros"' and 'fit=TRUE', these values reflect the predicted, more dense data as determined by <code>smoothing</code>,<code>smooth</code>, and <code>dens</code>.</p> 
<p><code>dat</code> a data table describing each have wave detected.</p><ul>
<li><p>'zeros': x value where y crosses zero. Returns NA if 'method=p2t'.</p></li>
<li><p>'wave.begin': x value where each half wave begins.</p></li>
<li><p>'wave.end': x value where each half wave ends.</p></li>
<li><p>'begin.index': x index of where each half wave begins.</p></li>
<li><p>'end.index': x index of where each half wave ends.</p></li>
<li><p>'wave': numeric name of each wave.</p></li>
<li><p>'l': the length of each half wave.</p></li>
<li><p>'amp1':  If method is set to 'p2t' this is the begin amplitude. If "method='zeros'", this is the maximum absolute amplitude between internodes.</p></li>
<li><p>'amp2': If method is set to 'p2t', this is the end amplitude. If "method='zeros' value is NA.</p></li>
<li><p>'pos1': If method is set to 'p2t', the x position of begin amplitude for each half wave and identical to 'begin'. If "method='zeros'", the position of maximum absolute amplitude between the internodes.</p></li>
<li><p>'pos2': If method is set to 'p2t', the x position of end amplitude for each half wave and identical to 'end'. If "method='zeros'", value is NA</p></li>
</ul>

<p>If 'method="zeros"' and 'fit=TRUE', these values reflect the predicted, more dense data as determined by <code>smoothing</code>, <code>smooth</code>, and <code>dens</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>If 'method="p2t"', half waves are found using critical points (i.e., local maxima and minima) with <code>features</code>. Detected half waves with this method can be either peak to trough or trough to peak.</p>
<p>If 'method="zeros"' and 'fit=TRUE', zero crossings are determined by first increasing the sample density by a factor determined by <code>dens</code>. A more dense <code><a href='https://rdrr.io/r/stats/loess.html'>loess</a></code> or <code><a href='https://rdrr.io/r/stats/smooth.spline.html'>smooth.spline</a></code> model is then fit to the data and new y values predicted. Wave positions and lengths are determined based on these predicted values. This option should be useful when the sampling density of the waveform is relatively low and therefor detected wave positions and zero crossings (the internodes) may be rather coarse.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code>features</code>, <code><a href='https://rdrr.io/r/stats/loess.html'>loess</a></code>, <code><a href='https://rdrr.io/r/stats/smooth.spline.html'>smooth.spline</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples">halfwave,Compute half wavelengths from a sine-like waveform,Compute half wavelengths from a sine-like waveform — halfwave,halfwave.Rd,character(0),halfwave,character(0),list(title = "Description", contents = "<p>Computes half wavelengths and their positions and amplitude from a sine-like waveform based on either peak-to-trough or internodal distance.</p>"),list(description = "Computes half wavelengths and their positions and amplitude from a sine-like waveform based on either peak-to-trough or internodal distance."),<span class='fu'>halfwave</span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>y</span>,
  method <span class='op'>=</span> <span class='st'>"zeros"</span>,
  zero.begin <span class='op'>=</span> <span class='cn'>TRUE</span>,
  fit <span class='op'>=</span> <span class='cn'>TRUE</span>,
  dens <span class='op'>=</span> <span class='fl'>10</span>,
  smooth <span class='op'>=</span> <span class='fl'>0.1</span>,
  smoothing <span class='op'>=</span> <span class='st'>"loess"</span>
<span class='op'>)</span>,list(list(name = "x", description = "<p>Numeric; x position</p>"), list(name = "y", description = "<p>numeric; y position</p>"), list(name = "method", description = "<p>character; how half waves should be found and classified, where it crosses zero/the internodal length (\"zeros\") or peak to trough/trough to peak (\"p2t\"). See Details.</p>"), list(name = "zero.begin", description = "<p>logical; does wave begin at zero? Default is 'TRUE' and will help find waves beginning at first x,y values if y=0</p>"), 
    list(name = "fit", description = "<p>logical; if 'method=\"zeros\"', should zeros be detected by a fitting operation. See Details.</p>"), list(name = "dens", description = "<p>numeric; factor by which to increase the sample density used in fitting when 'method=\"zeros\"'. See Details.</p>"), list(name = "smooth", description = "<p>numeric; if <code>smoothing</code> is set to 'loess', 'span' parameter value for <code><a href='https://rdrr.io/r/stats/loess.html'>loess</a></code>. If <code>smoothing</code> is set to 'spline' 'spar' parameter value for <code><a href='https://rdrr.io/r/stats/smooth.spline.html'>smooth.spline</a></code></p>"), 
    list(name = "smoothing", description = "<p>character; the smoothing method when 'fit=TRUE', either 'loess' or 'spline'. See Details.</p>")),TRUE,<div class='input'>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Loading required package: ggplot2</span></div><div class='input'>
<span class='co'>#Find length of the half waves</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='va'>pi</span>,<span class='fl'>0.01</span><span class='op'>)</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>sin</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>*</span><span class='va'>pi</span><span class='op'>)</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/qplot.html'>qplot</a></span><span class='op'>(</span><span class='va'>x</span>,<span class='va'>y</span><span class='op'>)</span>
</div><div class='img'><img src='halfwave-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>#zero method predicting zeros</span>
<span class='va'>w.z</span> <span class='op'>&lt;-</span> <span class='fu'>halfwave</span><span class='op'>(</span><span class='va'>x</span>,<span class='va'>y</span>,method<span class='op'>=</span><span class='st'>"zeros"</span>,fit<span class='op'>=</span><span class='cn'>TRUE</span>,smoothing<span class='op'>=</span><span class='st'>"spline"</span><span class='op'>)</span>

<span class='co'>#plot waveform with detected half waves using fitted 'zeros' method</span>
<span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>x</span>,y<span class='op'>=</span><span class='va'>y</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>p</span><span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>w.z</span><span class='op'>$</span><span class='va'>names</span>,<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>x</span>,y<span class='op'>=</span><span class='va'>y</span>,col<span class='op'>=</span><span class='va'>wave</span><span class='op'>)</span>,alpha<span class='op'>=</span><span class='fl'>0.4</span>,size<span class='op'>=</span><span class='fl'>3</span>,inherit.aes<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>p</span><span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_classic</a></span><span class='op'>(</span><span class='op'>)</span>
</div><div class='img'><img src='halfwave-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>#plot lambda as it varies with position</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/qplot.html'>qplot</a></span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>w.z</span><span class='op'>$</span><span class='va'>dat</span>,x<span class='op'>=</span><span class='va'>pos1</span>,y<span class='op'>=</span><span class='va'>l</span><span class='op'>)</span>
</div><div class='img'><img src='halfwave-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>#peak-to-trough method</span>
<span class='va'>w.p</span> <span class='op'>&lt;-</span> <span class='fu'>halfwave</span><span class='op'>(</span><span class='va'>x</span>,<span class='va'>y</span>,method<span class='op'>=</span><span class='st'>"p2t"</span><span class='op'>)</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/qplot.html'>qplot</a></span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>w.p</span><span class='op'>$</span><span class='va'>names</span>,x<span class='op'>=</span><span class='va'>x</span>,y<span class='op'>=</span><span class='va'>y</span>,col<span class='op'>=</span><span class='va'>wave</span><span class='op'>)</span>
</div><div class='img'><img src='halfwave-4.png' alt='' width='700' height='433' /></div><div class='input'>

</div>,list(list(title = "Value", contents = "<p>A list with the following components:</p>\n<p><code>method</code> the method chosen to find half waves</p>\n<p><code>names</code> a data table with columns 'x', 'y', and 'wave' describing the x and y positions of the wave and a numeric name of each half wave detected, resptively.  If 'method=\"zeros\"' and 'fit=TRUE', these values reflect the predicted, more dense data as determined by <code>smoothing</code>,<code>smooth</code>, and <code>dens</code>.</p> \n<p><code>dat</code> a data table describing each have wave detected.</p><ul>\n<li><p>'zeros': x value where y crosses zero. Returns NA if 'method=p2t'.</p></li>\n<li><p>'wave.begin': x value where each half wave begins.</p></li>\n<li><p>'wave.end': x value where each half wave ends.</p></li>\n<li><p>'begin.index': x index of where each half wave begins.</p></li>\n<li><p>'end.index': x index of where each half wave ends.</p></li>\n<li><p>'wave': numeric name of each wave.</p></li>\n<li><p>'l': the length of each half wave.</p></li>\n<li><p>'amp1':  If method is set to 'p2t' this is the begin amplitude. If \"method='zeros'\", this is the maximum absolute amplitude between internodes.</p></li>\n<li><p>'amp2': If method is set to 'p2t', this is the end amplitude. If \"method='zeros' value is NA.</p></li>\n<li><p>'pos1': If method is set to 'p2t', the x position of begin amplitude for each half wave and identical to 'begin'. If \"method='zeros'\", the position of maximum absolute amplitude between the internodes.</p></li>\n<li><p>'pos2': If method is set to 'p2t', the x position of end amplitude for each half wave and identical to 'end'. If \"method='zeros'\", value is NA</p></li>\n</ul>\n\n<p>If 'method=\"zeros\"' and 'fit=TRUE', these values reflect the predicted, more dense data as determined by <code>smoothing</code>, <code>smooth</code>, and <code>dens</code>.</p>", 
    slug = "value"), list(title = "Details", contents = "<p>If 'method=\"p2t\"', half waves are found using critical points (i.e., local maxima and minima) with <code>features</code>. Detected half waves with this method can be either peak to trough or trough to peak.</p>\n<p>If 'method=\"zeros\"' and 'fit=TRUE', zero crossings are determined by first increasing the sample density by a factor determined by <code>dens</code>. A more dense <code><a href='https://rdrr.io/r/stats/loess.html'>loess</a></code> or <code><a href='https://rdrr.io/r/stats/smooth.spline.html'>smooth.spline</a></code> model is then fit to the data and new y values predicted. Wave positions and lengths are determined based on these predicted values. This option should be useful when the sampling density of the waveform is relatively low and therefor detected wave positions and zero crossings (the internodes) may be rather coarse.</p>", 
    slug = "details"), list(title = "See also", contents = "<div class='dont-index'><p><code>features</code>, <code><a href='https://rdrr.io/r/stats/loess.html'>loess</a></code>, <code><a href='https://rdrr.io/r/stats/smooth.spline.html'>smooth.spline</a></code></p></div>", slug = "see-also")),2021,list(name = "trackter", version = "0.1.1", authors = "Christopher Kenaley"),list(destination = "dev", mode = "release", version_label = "default", version_tooltip = "Released version", in_dev = FALSE),list(root = "../", title = "trackter"),list(),list(type = "default", left = "<li>\n  <a href=\"../index.html\">\n    <span class=\"fas fa-home fa-lg\"></span>\n     \n  </a>\n</li>\n<li>\n  <a href=\"../reference/index.html\">Reference</a>\n</li>\n<li class=\"dropdown\">\n  <a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\" role=\"button\" aria-expanded=\"false\">\n    Articles\n     \n    <span class=\"caret\"></span>\n  </a>\n  <ul class=\"dropdown-menu\" role=\"menu\">\n    <li>\n      <a href=\"../articles/tutorial.html\">tutorial</a>\n    </li>\n  </ul>\n</li>\n<li>\n  <a href=\"../news/index.html\">Changelog</a>\n</li>", 
    right = ""),list(bootswatch = "cerulean", .present = TRUE),list(version = "1.6.1"),FALSE</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Christopher Kenaley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


