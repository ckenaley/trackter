<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kinematic Analysis • trackter</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Kinematic Analysis">
<meta property="og:description" content="trackter">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">trackter</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/image_analysis.html">Image Analysis</a>
    </li>
    <li>
      <a href="../articles/kinematic_analysis.html">Kinematic Analysis</a>
    </li>
    <li>
      <a href="../articles/startup.html">Starting Up</a>
    </li>
    <li>
      <a href="../articles/visualization.html">Visualization</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Kinematic Analysis</h1>
            
      
      
      <div class="hidden name"><code>kinematic_analysis.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="user-input">User input<a class="anchor" aria-label="anchor" href="#user-input"></a>
</h2>
<p>If the starting point of analysis is a video file, <code>trackter</code>’s <code>video.to.images()</code>, a wrapper for the <code>av</code> package’s <code>av_encode_video()</code> function, can be used to extract images to a user-defined directory. For example, the following will extract images from an 56-frame video shot at 100 fps of a swimming rainbow trout included with the package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">trackter</span><span class="op">)</span>
<span class="va">trout.vid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/vid"</span>, <span class="st">"trout.avi"</span>, package <span class="op">=</span> <span class="st">"trackter"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="st">"./trout_images"</span><span class="op">)</span>
<span class="fu"><a href="../reference/vid.to.images.html">vid.to.images</a></span><span class="op">(</span>vid.path <span class="op">=</span> <span class="va">trout.vid</span>, out.dir <span class="op">=</span> <span class="st">"./trout_images"</span><span class="op">)</span></code></pre></div>
<p>Here, the first image stored in the output directory is displayed to see what we’re dealing with.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">EBImage</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/EBImage/man/display.html" class="external-link">display</a></span><span class="op">(</span><span class="fu">EBImage</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/EBImage/man/io.html" class="external-link">readImage</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="st">"./trout_images"</span>,full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,method <span class="op">=</span> <span class="st">"raster"</span><span class="op">)</span></code></pre></div>
<p><img src="kinematic_analysis_files/figure-html/displayimg-1.png" width="700"></p>
<p>After image extraction, position and shape data can be retrieved using one of the <code>kin</code> functions: <code><a href="../reference/kin.search.html">kin.simple()</a></code>, <code><a href="../reference/kin.search.html">kin.search()</a></code> or <code><a href="../reference/kin.search.html">kin.free()</a></code>. Because this is a simple case of a fish swimming horizontally in the image field, <code><a href="../reference/kin.search.html">kin.simple()</a></code> works just fine. Users should consult <a href="image_analysis.html">this article</a> to get a sense of which function may apply to their experiments.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">trout.kin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kin.search.html">kin.simple</a></span><span class="op">(</span>image.dir <span class="op">=</span> <span class="st">"./trout_images"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: `data_frame()` was deprecated in tibble 1.1.0.</span>
<span class="co">## Please use `tibble()` instead.</span>
<span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span>
<span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="frequency-and-amplitude">Frequency and amplitude<a class="anchor" aria-label="anchor" href="#frequency-and-amplitude"></a>
</h2>
<p>Once shape and position data are retrieved, users can move on to downstream kinematic analysis with several functions included with <code>trackter</code>. Here, the <code>kin.dat</code> data table returned by <code><a href="../reference/kin.search.html">kin.simple()</a></code>, which includes frame-specific trailing edge position (the “x” and “y” columns), is passed to the function <code><a href="../reference/amp.freq.html">amp.freq()</a></code>. This function computes amplitude as half the distance between each successive pairs of critical points (i.e., points where the derivative is zero). Frequencies are calculated as the inverse of the the peak-to-peak periods (if the first critical point is a peak) or trough-to-trough periods (if the first critical point is a trough) given a certain sampling frequency defined by <code>sf</code>. In addition, `<code><a href="../reference/amp.freq.html">amp.freq()</a></code> returns a vector of the positions of the critical points (<code>pos</code>) with respect to the <code>x</code> value the signal-to-noise ration (<code>snr</code>).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">trout.kin</span><span class="op">$</span><span class="va">kin.dat</span>,<span class="fu"><a href="../reference/amp.freq.html">amp.freq</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">frame</span>,y<span class="op">=</span><span class="va">y</span>,sf<span class="op">=</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## $a</span>
<span class="co">## [1] 26.81706 25.80780 29.46852 35.19444</span>
<span class="co">## </span>
<span class="co">## $pos</span>
<span class="co">## [1]  3 18 29 41 56</span>
<span class="co">## </span>
<span class="co">## $f</span>
<span class="co">## [1] 3.743916 3.745318</span>
<span class="co">## </span>
<span class="co">## $snr</span>
<span class="co">## [1] 25.09</span></code></pre>
</div>
<div class="section level2">
<h2 id="wavelength">Wavelength<a class="anchor" aria-label="anchor" href="#wavelength"></a>
</h2>
<p>Propulsive wavelength can be calculated with one of two functions in <code>trackter</code>, <code><a href="../reference/wave.html">wave()</a></code> or <code>half.wave()</code>. Both are intended to be used to compute full or half wavelengths, respectively, from the <code>midline</code> data table returned by the <code>kin</code> function.</p>
<p>The <code>midldine</code> data table returned from the <code>kin</code> functions includes “wave.y”, the amplitude of the midline relative to a linear prediction the head. A classic midline waveform plot of frame-specific “wave.y” versus body position (“per.bl”) follows.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/qplot.html" class="external-link">qplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">trout.kin</span><span class="op">$</span><span class="va">midline</span>,x<span class="op">=</span><span class="va">per.bl</span>,y<span class="op">=</span><span class="va">wave.y</span>,col<span class="op">=</span><span class="va">frame</span><span class="op">)</span></code></pre></div>
<p><img src="kinematic_analysis_files/figure-html/midlineplot-1.png" width="700"></p>
<p>As the path of the head can be thought of as an axis of progression of the propulsive wave, the example below computes the half wavelength with “wave.y” and plots half wavelength versus body position.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="va">wave.dat</span> <span class="op">&lt;-</span><span class="va">trout.kin</span><span class="op">$</span><span class="va">midline</span><span class="op">[</span>, <span class="op">{</span> <span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/halfwave.html">halfwave</a></span><span class="op">(</span><span class="va">per.bl</span>,<span class="va">wave.y</span>,method<span class="op">=</span><span class="st">"zeros"</span><span class="op">)</span><span class="op">$</span><span class="va">dat</span>;
 <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>l<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">w</span><span class="op">$</span><span class="va">l</span><span class="op">)</span>,
    amp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">w</span><span class="op">$</span><span class="va">amp1</span><span class="op">)</span>,
    pos<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">w</span><span class="op">$</span><span class="va">pos1</span><span class="op">)</span>,
    start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">w</span><span class="op">$</span><span class="va">wave.begin</span><span class="op">)</span>,
    end<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">w</span><span class="op">$</span><span class="va">wave.end</span><span class="op">)</span><span class="op">)</span><span class="op">}</span>,
     by<span class="op">=</span><span class="fu">.</span><span class="op">(</span><span class="va">frame</span><span class="op">)</span><span class="op">]</span>

<span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/qplot.html" class="external-link">qplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">wave.dat</span>,x<span class="op">=</span><span class="va">pos</span>,y<span class="op">=</span><span class="va">l</span><span class="op">)</span></code></pre></div>
<p><img src="kinematic_analysis_files/figure-html/waveplot-1.png" width="700"></p>
<p>Both <code><a href="../reference/wave.html">wave()</a></code> and <code><a href="../reference/halfwave.html">halfwave()</a></code> compute the wavelength according to one of several methods defined by the argument <code>method</code>. In <code><a href="../reference/halfwave.html">halfwave()</a></code>, if <code>method='p2t'</code>, half waves are calculated as the distance between critical points, i.e., between each successive peak-to-trough and trough-to-peak pairs. If <code>method='zeros'</code>, nodes where the waveform crosses the <code>x</code> value vector are determined and the half waves are calculated as the internodal distances. In <code><a href="../reference/wave.html">wave()</a></code>, full wavelengths are calculated similarly as the peak-to-peak (<code>method='p2p'</code>), trough-to-trough (<code>method='t2t'</code>) or internodal distances (<code>method='zeros'</code>).</p>
</div>
<div class="section level2">
<h2 id="analysis-of-fin-like-extensions">Analysis of fin-like extensions<a class="anchor" aria-label="anchor" href="#analysis-of-fin-like-extensions"></a>
</h2>
<p>The utility of <code>trackter</code> is not limited to analyses of body kinematics. Contour data returned by the <code>kin</code> functions can be passed to <code><a href="../reference/fin.kin.html">fin.kin()</a></code> to determine 2D fin position. This function isolates two opposing sub-regions of the contour defined by the<code>fin.pos</code> argument, a value meant to represent the anterior and posterior position of the pectoral fins as a portion of body length (e.g., <code>c(0.25,0.55)</code> as in the example below).</p>
<p>From the isolated and smoothed right and left fin outlines, the positions of the tip of the fin appendages is estimated in two ways. The first is simply the point in each appendage that is farthest from the base of the fin. The base is estimated as a straight line between the contour coordinates that match <code>fin.pos</code>. The second is a little more complicated and starts with calculating the distance between each fins contour coordinates and the midpoint of the fin base. <code>features()</code> from the <code>features</code> package is then used to calculate an inflection in this distance. The point of this inflection with the maximum orthogonal distance from the base is used to estimate the fin position. Such an algorithm for this second methods assumes that the tip of each fin is is pointed, a safe assumption for the pectoral fins of many ray-finned fishes. To speed up calculation of fin points, the contour resolution can be reduced with the <code>red</code> argument.</p>
<p>For the following example, we begin by extracting images from a 120-frame video of a pumpkinseed sunfish swimming with its pectoral fins that’s included with the package. For this we’ll use <code>trackter</code>’s <code><a href="../reference/vid.to.images.html">vid.to.images()</a></code> function.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#get file path</span>
<span class="va">pseed.vid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/vid"</span>, <span class="st">"sunfish_pect.avi"</span>, package <span class="op">=</span> <span class="st">"trackter"</span><span class="op">)</span>
<span class="co">#create directory to store images</span>
<span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="st">"pect_images"</span><span class="op">)</span>
<span class="co">#extract images</span>
<span class="fu"><a href="../reference/vid.to.images.html">vid.to.images</a></span><span class="op">(</span>vid.path <span class="op">=</span> <span class="va">pseed.vid</span>, out.dir <span class="op">=</span> <span class="st">"./pect_images"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Extra audio frame dropped from output</span></code></pre>
<p>To extract body and fin contours from the image data, <code><a href="../reference/kin.search.html">kin.simple()</a></code> can be used. This and the other <code>kin</code> functions isolate the target ROI through <a href="image_analysis.html">thresholding and segmentation</a>. By default, the threshold value is determined automatically using Otsu’s method. However, users interested in retrieving fin contours with the <code>kin</code> functions should evaluate whether this automatic value is appropriate. Fin appendages in fishes are often translucent and lower threshold values may result in an eroded fin contour. Kinematic analysis of fins based on these eroded contours would be compromised.</p>
<p>Therefore, users are advised to begin fin analysis with an inspection of the threshold values using <code>trackter</code>’s <a href="image_analysis.html#thresholding"><code>thr.check()</code> function</a>. Here, the binary results of 9 separate threshold values (from 0.1–0.9) for the first image of the sequence is evaluated using <code><a href="../reference/thr.check.html">thr.check()</a></code>. In addition, <code><a href="../reference/thr.check.html">thr.check()</a></code> returns the Otsu value for comparison.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/thr.check.html">thr.check</a></span><span class="op">(</span><span class="st">"./pect_images/sunfish_pect_000001.jpg"</span><span class="op">)</span></code></pre></div>
<p><img src="kinematic_analysis_files/figure-html/thrcheck-1.png" width="700"></p>
<pre><code><span class="co">## [1] 0.5527344</span></code></pre>
<p>From these results, it appears that a threshold value of 0.8 captures the fin contours but doesn’t introduce too much noise. Note that this is much higher than the Otsu value of 0.55. With this more appropriate threshold value, segmentation and contour extraction can commence. The contour of the first frame (contained in the <code>cont</code> data table returned by <code><a href="../reference/kin.search.html">kin.simple()</a></code>) is plotted to confirm that the fins were captured well enough.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#run kin.search()</span>
<span class="va">pect.kin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kin.search.html">kin.search</a></span><span class="op">(</span>image.dir <span class="op">=</span> <span class="st">"pect_images"</span>,thr <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>

<span class="co">#plot the contour</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/qplot.html" class="external-link">qplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">pect.kin</span><span class="op">$</span><span class="va">cont</span><span class="op">[</span><span class="va">frame</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span>,<span class="va">x</span>,<span class="va">y</span><span class="op">)</span></code></pre></div>
<p><img src="kinematic_analysis_files/figure-html/kinsearch-1.png" width="700"></p>
<p>Now, <code><a href="../reference/fin.kin.html">fin.kin()</a></code> is run by passing the tables returned by <code><a href="../reference/kin.search.html">kin.simple()</a></code> to the <code>kin</code> argument and specifying that the fins begin and end at 25% and 50% of the of the body length (<code>fin.pos = c(0.25, 0.55)</code>). The contour resolution is reduced by 50% (<code>red=0.5</code>) to hasten the run time.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># run fin.kin()</span>
<span class="va">fin.dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fin.kin.html">fin.kin</a></span><span class="op">(</span>kin<span class="op">=</span><span class="va">pect.kin</span>,fin.pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.55</span><span class="op">)</span>,red<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<p>Like the <code>kin</code> functions, <code><a href="../reference/fin.kin.html">fin.kin()</a></code> returns a list of tables.</p>
<ul>
<li>
<code>cont</code>: frame-specific x,y coordinates of the body contour received from the <code>kin</code> argument.</li>
<li>
<code>fin</code>: frame-specific x,y coordinates of each fin (“a” or “b”). +<code>fin.pts</code>: frame-specific x,y coordinates of the fin tip, start, and end positions.</li>
<li>
<code>comp</code>: frame-specific x,y coordinates of the body contour minus the fins.</li>
<li>
<code>midline</code>: frame-specific estimation of the midline coordinates.</li>
<li>amp frame-specific fin amplitudes based on each method of finding the fin tip.</li>
<li>
<code>bl</code>: the body length in pixels.</li>
</ul>
<p>From the <code>amp</code> table retrieved by <code><a href="../reference/fin.kin.html">fin.kin()</a></code>, we can plot the frame-specific fin amplitude in pixels. Here, “amp1” is used, an amplitude determined based on a point in each appendage that is farthest from the base of the fin.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/qplot.html" class="external-link">qplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">fin.dat</span><span class="op">$</span><span class="va">amp</span>,x<span class="op">=</span><span class="va">frame</span>,y<span class="op">=</span><span class="va">amp1</span>,col<span class="op">=</span><span class="va">side</span>,geom<span class="op">=</span><span class="st">"line"</span><span class="op">)</span></code></pre></div>
<p><img src="kinematic_analysis_files/figure-html/amp1-1.png" width="700"></p>
<p>Here’s “amp2”, amplitude based on a sharp feature of the fin, is plotted for comparison.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/qplot.html" class="external-link">qplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">fin.dat</span><span class="op">$</span><span class="va">amp</span>,x<span class="op">=</span><span class="va">frame</span>,y<span class="op">=</span><span class="va">amp2</span>,col<span class="op">=</span><span class="va">side</span>,geom<span class="op">=</span><span class="st">"line"</span><span class="op">)</span></code></pre></div>
<p><img src="kinematic_analysis_files/figure-html/amp2-1.png" width="700"></p>
<p>In addition to fin amplitude and contour extraction, <code><a href="../reference/fin.kin.html">fin.kin()</a></code> also produces a composite contour of the body minus the fin area described by the <code>fin.pos</code> argument. Fin contours are replaced by a simple linear prediction constructed from the coordinates of the first and last values covered by <code>fin.pos</code>. The result is a straight line between the start and end of each fin. From this composite body contour, a midline prediction is made based on a smooth spline with the amount of smoothing controlled by the argument <code>ml.smooth</code>.</p>
<p>Here, the contour of the frame 96 is plotted with the tracked fin tips and composite midline.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fin.90</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">fin.dat</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="va">frame</span><span class="op">==</span><span class="fl">96</span><span class="op">]</span><span class="op">)</span>

<span class="va">p.fin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fin.90</span><span class="op">$</span><span class="va">cont</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>,size<span class="op">=</span><span class="fl">1</span>,col<span class="op">=</span><span class="st">"gray"</span><span class="op">)</span>

<span class="va">p.fin</span> <span class="op">&lt;-</span> <span class="va">p.fin</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fin.90</span><span class="op">$</span><span class="va">fin</span>, <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, col <span class="op">=</span> <span class="va">side</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>

<span class="va">p.fin</span> <span class="op">&lt;-</span> <span class="va">p.fin</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fin.90</span><span class="op">$</span><span class="va">midline</span>, <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="va">p.fin</span> <span class="op">&lt;-</span> <span class="va">p.fin</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fin.90</span><span class="op">$</span><span class="va">fin.pts</span><span class="op">[</span><span class="va">pos</span><span class="op">==</span><span class="st">"tip2"</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">4</span>,shape<span class="op">=</span><span class="fl">10</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p.fin</span><span class="op">)</span></code></pre></div>
<p><img src="kinematic_analysis_files/figure-html/finplot-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Christopher Kenaley.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
