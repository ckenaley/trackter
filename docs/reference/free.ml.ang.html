<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Midline estimations for closed contours — free.ml.ang • trackter</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Midline estimations for closed contours — free.ml.ang" />
<meta property="og:description" content="Internal functions used in kin functions for calculating the long-axis midlline spanning a closed contour.
free.ml.ang estimates a midline by finding angular tips that lie in end regions of the long axis of a contour and bisects the contour according to these tips.
free.ml.hull estimates a midline by finding the most distant coordinates in the convex hull and then bisects the contour according to these tips.
free.ml.del estimates a midline through Delaunay triangulation and Voronoi tesselation." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">trackter</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/image_analysis.html">Image Analysis</a>
    </li>
    <li>
      <a href="../articles/kinematic_analysis.html">Kinematic Analysis</a>
    </li>
    <li>
      <a href="../articles/startup.html">Starting Up</a>
    </li>
    <li>
      <a href="../articles/visualization.html">Visualization</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Midline estimations for closed contours</h1>
    
    <div class="hidden name"><code>free.ml.ang.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Internal functions used in <code>kin</code> functions for calculating the long-axis midlline spanning a closed contour.</p>
<p><code>free.ml.ang</code> estimates a midline by finding angular tips that lie in end regions of the long axis of a contour and bisects the contour according to these tips.</p>
<p><code>free.ml.hull</code> estimates a midline by finding the most distant coordinates in the convex hull and then bisects the contour according to these tips.</p>
<p><code>free.ml.del</code> estimates a midline through Delaunay triangulation and Voronoi tesselation.</p>
    </div>

    <pre class="usage"><span class='fu'>free.ml.ang</span><span class='op'>(</span>out <span class='op'>=</span> <span class='cn'>NULL</span>, smooth.n <span class='op'>=</span> <span class='cn'>NULL</span>, dens <span class='op'>=</span> <span class='cn'>NULL</span>, red <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>

<span class='fu'>free.ml.hull</span><span class='op'>(</span>out <span class='op'>=</span> <span class='cn'>NULL</span>, smooth.n <span class='op'>=</span> <span class='cn'>NULL</span>, dens <span class='op'>=</span> <span class='cn'>NULL</span>, red <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>

<span class='fu'>free.ml.del</span><span class='op'>(</span>out <span class='op'>=</span> <span class='cn'>NULL</span>, smooth.n <span class='op'>=</span> <span class='cn'>NULL</span>, red <span class='op'>=</span> <span class='cn'>NULL</span>, dens <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>out</th>
      <td><p>a matrix of named x,y values describing a closed outline (contour)</p></td>
    </tr>
    <tr>
      <th>smooth.n</th>
      <td><p>the number of smoothing iterations. See Details</p></td>
    </tr>
    <tr>
      <th>dens</th>
      <td><p>integer,  the factor by which to densify the contour. Will slow down midline estimations but may increase the likelihood of finding a pointed tip. If 'NULL', the original contour in <code>out</code> will be used See Details.</p></td>
    </tr>
    <tr>
      <th>red</th>
      <td><p>numeric, between 0-1 the proportion of contour coordinates to sample. Will speed up midline estimations. If 'NULL', the full contour in <code>out</code> will be used See Details.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with the following components:</p>
<p><code>ml</code>: a data table consisting of the x,y coordinates of the midline and their index value</p>
<p><code>cont.sm</code>: a data table containing the smoothed outline according to <code>coo_smooth</code>. If 'smooth.n=0', this will be identical to the input 'out'.</p>
<p><code>cont.sides</code>: a data table containing the smoothed outline factorized by side 'a' or 'b' and index.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>free.ml.ang</code> estimates the midline by first creating a convex hull of the contour and then finding candidate tips that are farthest from one another with <code><a href='https://rdrr.io/pkg/Momocs/man/coo_truss.html'>coo_truss</a></code>. This and <code>free.ml.hull</code> therefore assume the contour is elongate. The candidate tips are then refined by finding coordinates whose index are within the 5<!-- % quantiles of the extrema. From the additional coordinates, the final candidate tips are defined as those that form the greatest angle between adjacent coordinates. The function then **bisects** the contour across this axis determined by the tips using \code{\link{coo_slice}}, giving it two sides with coordinates of equal length. The midline is calculated as the midpoints defined between all pairs of coordinates with the same index value. --></p>
<p><code>free.ml.hull</code> creates a convex hull of the contour and then finds the two coordinates in the hull that are farthest from one another. As with <code>free.ml.ang</code>, this function then bisects the contour across an axis determined by the tips and calculates the midline as midpoints defined between all pairs of coordinates with the same index value</p>

<p><code>free.ml.del</code> estimates the midline by first finding candidate tips of the contour. Midline coordinates are retrieved through Delaunay triangulation and Voronoi tesselation. Triangulated points that lie within the contour are used to build a distance-weighted minimum spanning tree that expands until the the path intersects with the contour. The extrema of the midline path are then indexed as the first and last according to their distance from the candidate tips.</p>
<p>The use of <code>free.ml.ang</code> and <code>free.ml.hull</code> may be more appropriate for complicated outlines (i.e., those with appendages). The use of <code>free.ml.del</code> produces better results when contour regions overlap (i.e, kinks or snakes back on itself), but produces less precise midlines for complicated contours and is slower for high resolution outlines. Reducing the resolution with 'red' may hasten the speed.</p>
<p>'smooth.n' is passed to the 'n' parameter of <code><a href='https://rdrr.io/pkg/Momocs/man/coo_smooth.html'>coo_smooth</a></code>, which smooths coordinates using a simple moving average. Users should be careful not to oversmooth. If the input contour has few points (say just a 100 or so extracted from <code>kin</code> functions run on low resolution images), much detail will be lost. In general, 'smooth.n' should be &lt;5.</p>
<p>If 'red' is specified, the resolution of the contour is reduced by invoking <code><a href='https://rdrr.io/pkg/Momocs/man/coo_interpolate.html'>coo_interpolate</a></code> with 'n' of this function equal to 'red' times the number of coordinates in the original contour.</p>
<p>For input contours with few points (say &gt;100), users should consider densifying with 'dens'. For example, an input contour with 100 coordinates would be transformed to one of 200 with 'dens=1'.</p>
<p>A humble thanks to Barry Rowlingson of Lancaster University for his <a href='https://stackoverflow.com/questions/9595117/identify-a-linear-feature-on-a-raster-map-and-return-a-linear-shape-object-using/9643004#9643004'>answer to a post on Stack Overflow</a> that inspired the logic behind <code>free.ml.del</code>.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>These functions do not make decisions about position, i.e, output values of 'n', although ordered along the long axis of the contour, may be differently arranged given the rotation of the contour.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/pkg/Momocs/man/coo_smooth.html'>coo_smooth</a></code>, <code><a href='https://rdrr.io/pkg/Momocs/man/coo_slice.html'>coo_slice</a></code>,<code><a href='https://rdrr.io/pkg/Momocs/man/coo_slide.html'>coo_slide</a></code>, <code><a href='https://rdrr.io/pkg/Momocs/man/coo_truss.html'>coo_truss</a></code>, <code><a href='kin.search.html'>kin.free</a></code>, <code>deldir</code>, <code><a href='kin.search.html'>kin.free</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># a lateral midline, but a midline nonetheless</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/MomX/Momocs/'>Momocs</a></span><span class='op'>)</span>
<span class='va'>o</span> <span class='op'>&lt;-</span> <span class='fu'>Momocs</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/Momocs/man/data_nsfishes.html'>nsfishes</a></span><span class='op'>$</span><span class='va'>coo</span><span class='op'>[[</span><span class='fl'>136</span><span class='op'>]</span><span class='op'>]</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>o</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"x"</span>,<span class='st'>"y"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>o</span><span class='op'>)</span>
</div><div class='input'><span class='va'>fml</span> <span class='op'>&lt;-</span> <span class='fu'>free.ml.hull</span><span class='op'>(</span><span class='va'>o</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>fml</span><span class='op'>$</span><span class='va'>ml</span><span class='op'>$</span><span class='va'>x</span>,<span class='va'>fml</span><span class='op'>$</span><span class='va'>ml</span><span class='op'>$</span><span class='va'>y</span>,col<span class='op'>=</span><span class='st'>"red"</span><span class='op'>)</span>
</div><div class='input'>
<span class='co'>#note the difference</span>
<span class='co'>#fml2 &lt;- free.ml.ang(o) </span>
<span class='co'>#points(fml2$ml$x,fml2$ml$y,col="blue")</span>

<span class='co'># with free.ml.del, a poorer choice</span>
<span class='va'>fml3</span> <span class='op'>&lt;-</span> <span class='fu'>free.ml.del</span><span class='op'>(</span><span class='va'>o</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>fml3</span><span class='op'>$</span><span class='va'>ml</span><span class='op'>$</span><span class='va'>x</span>,<span class='va'>fml3</span><span class='op'>$</span><span class='va'>ml</span><span class='op'>$</span><span class='va'>y</span>,col<span class='op'>=</span><span class='st'>"green"</span><span class='op'>)</span>
</div><div class='input'>
<span class='co'>#free.ml.del with the contour of a swimming worm, C. elegans</span>
<span class='co'>#from SI Video 3 of Pierce-Shimomura, et al., 2008.</span>
<span class='co'># Genetic analysis of crawling and swimming locomotory patterns in C. elegans. </span>
<span class='co'>#Proceedings of the National Academy of Sciences, 105(52), pp.20982-20987.</span>

<span class='va'>cel</span> <span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata"</span>, <span class='st'>"celegans.csv"</span>, package <span class='op'>=</span> <span class='st'>"trackter"</span><span class='op'>)</span>
<span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/as.matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span><span class='va'>cel</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>#smooth it</span>
<span class='va'>out.sm</span> <span class='op'>&lt;-</span> <span class='fu'>Momocs</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/Momocs/man/coo_smooth.html'>coo_smooth</a></span><span class='op'>(</span><span class='va'>out</span>,n<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>

<span class='va'>fml.del</span> <span class='op'>&lt;-</span> <span class='fu'>free.ml.del</span><span class='op'>(</span><span class='va'>out.sm</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>fml.del</span><span class='op'>$</span><span class='va'>ml</span><span class='op'>$</span><span class='va'>x</span>,<span class='va'>fml.del</span><span class='op'>$</span><span class='va'>ml</span><span class='op'>$</span><span class='va'>y</span>,col<span class='op'>=</span><span class='st'>"red"</span><span class='op'>)</span>
</div><div class='img'><img src='free.ml.ang-1.png' alt='' width='700' height='433' /></div><div class='input'>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Christopher Kenaley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


